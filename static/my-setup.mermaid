flowchart LR
    %% Users
    Admin[ğŸ‘¤ Power Users]
    Family[ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ Family Members]

    %% External Services
    VPS[ğŸ¢ Hetzner VPS<br/>wg-easy Server<br/>10.8.0.1]
    CF[ğŸš‡ Cloudflare Tunnels]

    %% Home Network Container
    subgraph Home ["ğŸ  Home Network (192.168.1.0/24)"]
        Devices[ğŸ“± Local Devices]
        MainPihole[ğŸ›¡ï¸ Main Pi-hole<br/>192.168.1.10]

        subgraph RPI ["ğŸ“ Raspberry Pi Central Hub"]
            WGClient[ğŸ”’ WireGuard Client]
            PiholeRPI[ğŸ›¡ï¸ Pi-hole DNS]
            Nginx[âš¡ Nginx Proxy Manager]
        end

        subgraph YAMS ["ğŸ¬ YAMS Server"]
            Emby[ğŸ“º Emby]
            Radarr[ğŸ¬ Radarr]
            Sonarr[ğŸ“º Sonarr]
            QB[â¬‡ï¸ qBittorrent]
            Other[âš™ï¸ Other Services]
        end
    end

    %% User connections
    Admin -.-> VPS
    Family -.-> CF

    %% VPN path
    VPS <--> WGClient

    %% Local network connections
    Devices --> MainPihole
    MainPihole --> Nginx

    %% VPN DNS routing
    WGClient --> PiholeRPI
    PiholeRPI --> Nginx

    %% Direct tunnel
    CF --> Emby

    %% Nginx proxies everything
    Nginx --> Emby
    Nginx --> Radarr
    Nginx --> Sonarr
    Nginx --> QB
    Nginx --> Other

    %% Styling
    classDef userStyle fill:#e3f2fd,stroke:#1976d2,stroke-width:2px
    classDef externalStyle fill:#fff3e0,stroke:#f57c00,stroke-width:2px
    classDef serviceStyle fill:#e8f5e8,stroke:#388e3c,stroke-width:2px

    class Admin,Family userStyle
    class VPS,CF externalStyle
    class Devices,MainPihole,WGClient,PiholeRPI,Nginx serviceStyle
    class Emby,Radarr,Sonarr,QB,Other serviceStyle
